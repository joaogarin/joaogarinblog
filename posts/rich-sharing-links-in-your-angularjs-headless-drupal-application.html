<!doctype html>
<html lang="en">


<head>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>joaogarin | Rich sharing links in your angularJs headless drupal application</title>
  <meta name="description" content="Learn how to enable rich sharing links in your AngularJs application.">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="Rich sharing links in your angularJs headless drupal application">
  <meta property="og:type" content="website">
  <meta property="og:url" content="/posts/rich-sharing-links-in-your-angularjs-headless-drupal-application">
  <meta property="og:description" content="Learn how to enable rich sharing links in your AngularJs application.">
  <meta property="og:site_name" content="joaogarin">
  <meta property="og:image" content="/posts/image-angular-social.jpg">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="/posts/rich-sharing-links-in-your-angularjs-headless-drupal-application">
  <meta name="twitter:title" content="Rich sharing links in your angularJs headless drupal application">
  <meta name="twitter:description" content="Learn how to enable rich sharing links in your AngularJs application.">
  <meta name="twitter:image" content="/posts/image-angular-social.jpg">

  <link href="/feed.xml" type="application/rss+xml" rel="alternate" title="joaogarin Last 10 blog posts" />

  

  
    <link rel="icon" type="image/x-icon" href="/assets/favicon-light-a98c41efc5ed9fcc06ac664c9e2f7a9b3c3b2e0a52357d221fe382f6f4abc8fc.ico">
    <link rel="apple-touch-icon" href="/assets/apple-touch-icon-light-87d1f2a3a19b1500e5c1626a0492025ca5f7f97d24540dc5900288e92112925a.png">
    <link rel="stylesheet" type="text/css" href="/assets/light-bb1553a18d0f1ccfe1aabc010584c49b4277a88503216b78906ba719e30019c1.css">
  
</head>

<body>
  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav scrollappear">
  <a href="/" class="header-logo" title="joaogarin">joaogarin</a>
  <ul class="header-links">
    
      <li>
        <a href="/about" title="About me">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-about">
  <use href="/assets/about-ecf154b571ab8034ae00aeed91a3b7ad68db80b46d958753ad6216c919486e88.svg#icon-about" xlink:href="/assets/about-ecf154b571ab8034ae00aeed91a3b7ad68db80b46d958753ad6216c919486e88.svg#icon-about"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a href="https://twitter.com/joaogarin" rel="noreferrer noopener" target="_blank" title="Twitter">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-twitter">
  <use href="/assets/twitter-8842c33965263ad1b03a978406826677a668f94125d5837e70ab83f24b3213a7.svg#icon-twitter" xlink:href="/assets/twitter-8842c33965263ad1b03a978406826677a668f94125d5837e70ab83f24b3213a7.svg#icon-twitter"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a href="https://www.facebook.com/joao.garin" rel="noreferrer noopener" target="_blank" title="Facebook">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-facebook">
  <use href="/assets/facebook-72c99b26d37bee65607720abb23d26b44ef30cca1187f98b0d9305be1230b1bf.svg#icon-facebook" xlink:href="/assets/facebook-72c99b26d37bee65607720abb23d26b44ef30cca1187f98b0d9305be1230b1bf.svg#icon-facebook"></use>
</svg>

        </a>
      </li>
    
    
    
      <li>
        <a href="https://github.com/joaogarin" rel="noreferrer noopener" target="_blank" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-github">
  <use href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github" xlink:href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
      <li>
        <a href="https://www.linkedin.com/in/joao-garin-9b118525" rel="noreferrer noopener" target="_blank" title="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-linkedin">
  <use href="/assets/linkedin-cdc5c107044324a3dfbea2e9ead15873f8dee304c37d73a046988956b706256e.svg#icon-linkedin" xlink:href="/assets/linkedin-cdc5c107044324a3dfbea2e9ead15873f8dee304c37d73a046988956b706256e.svg#icon-linkedin"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      <li>
        <a href="/feed.xml" rel="noreferrer noopener" target="_blank" title="RSS">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-rss">
  <use href="/assets/rss-541ec5cea9cefd10d2fcfec01888f3f231a8829940249835fa7b7b3a12ae0d0d.svg#icon-rss" xlink:href="/assets/rss-541ec5cea9cefd10d2fcfec01888f3f231a8829940249835fa7b7b3a12ae0d0d.svg#icon-rss"></use>
</svg>

        </a>
      </li>
    
  </ul>
</nav>

        <article class="article scrollappear">
          <header class="article-header">
            <h1>Rich sharing links in your angularJs headless drupal application</h1>
            <p>Learn how to enable rich sharing links in your AngularJs application.</p>
            <div class="article-list-footer">
              <span class="article-list-date">
                November 9, 2015
              </span>
              <span class="article-list-divider">-</span>
              <span class="article-list-minutes">
                
                
                  3 minute read
                
              </span>
              <span class="article-list-divider">-</span>
              <div class="article-list-tags">
                
                  <a href="/tag/web">web</a>
                
                  <a href="/tag/drupal">drupal</a>
                
              </div>
            </div>
          </header>

          <div class="article-content">
            <p><a href="/assets/posts/image-angular-social-72bcfb48f463728568fed0b7d60ee3ac2b40369f235798b6489508ee0a2298d7.jpg" data-rjs="/assets/posts/image-angular-social-72bcfb48f463728568fed0b7d60ee3ac2b40369f235798b6489508ee0a2298d7.jpg" class="fluidbox-trigger">
  <img src="/assets/posts/image-angular-social-72bcfb48f463728568fed0b7d60ee3ac2b40369f235798b6489508ee0a2298d7.jpg" alt="Angular social links" />
</a></p>

<p>Following on a <a href="http://www.michaelbromley.co.uk/blog/171/enable-rich-social-sharing-in-your-angularjs-app">great post</a> by <a href="https://twitter.com/michlbrmly">Michael Browmley</a> I decided to reshare this idea on how to enable rich sharing links in your AngularJs application.</p>

<p>The steps are really easy and enables you to have rich sharing links in you app with very little effort. I am going to focus on using this with Drupal rather than using a static php file like in the blog post from Michael.</p>

<h2 id="open-graph-and-specific-protocols">Open Graph and specific protocols</h2>

<p>Facebook and all the major social media platforms expect your page to have some specific metatags to better display Images, description and other information about the link you are sharing. The most common from facebook is the OpenGraph protocol. it looks something like this :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"> <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:title"</span> <span class="na">content=</span><span class="s">"Your own page title"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:description"</span> <span class="na">content=</span><span class="s">"A description of the page you are sharing."</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">"http://www.mysite.com/dist/images/nice_picture.jpg"</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/head&gt;</span></code></pre></figure>

<p>Twitter uses something simillar but with “twitter:” prefix instead of “og:”. Once you submit a page to be shared the crawler from facebook or twitter is going to start scan your page to find these tags, and also scan the regular HTML to find some images or tags that it can use to better display the link.</p>

<h2 id="the-problem-with-angularjs">The problem with AngularJs</h2>

<p>The problem with angular is that the page is rendered in Javascript and so there is no place where it can actually print a metatag with the correct information. Even if you do it dinamically via some service you would still render something like</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"> metadata.title 
 metadata.description</code></pre></figure>

<p>Because the crawler does not understand javascript and is expecting a immediate response of static content from the server, which he does not get he essencially cant resolve anything.</p>

<h2 id="the-solution---server-side-render-for-bot-crawlers">The Solution - server side render for bot crawlers</h2>

<p>Since you don’t care how the page displays to these crawlers but rather just have the necessary tags and meta info that they need, you can use a server page to render this result to the crawlers. The only important thing is to make sure that only crawlers get this response and normal users are still getting the normal “Angular” page. Worth mentioning that this sever side page is <a href="https://www.drupal.org">Drupal</a> which is giving us these pages essencially for free.</p>

<h3 id="we-will-be-needing">We will be needing</h3>

<ul>
  <li>A web server capable of URL rewriting. In this case, we are using Apache and the mod_rewrite module but we could use another option.</li>
  <li>A server-side page to generate our crawler-friendly pages. Because we are using Drupal, and these are nodes we basically have this for free. We just point the crawler to the Drupal node page and voilla, Meta info and a nice server side page. We can also enhance it with custom modules for better meta data as well.</li>
  <li>The Angular app must be using “html5mode” its URLs. This is because the # portion of a URL does not get sent to the server, so makes server-side redirection based on the Angular page impossible</li>
</ul>

<h2 id="apache-configuration">Apache Configuration</h2>

<p>In this example I have my own blog in which URL’s for specific pages match the ones in my blog_backoffice. So I have an angular page in http://joaogarin.com/blog/whats-coming-with-angular-2 and I simply point it to http://joaogarin.com/blog_backoffice/whats-coming-with-angular-2 which is the Drupal node for this page.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;ifModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteCond %<span class="o">{</span>HTTP_USER_AGENT<span class="o">}</span> <span class="o">(</span>facebookexternalhit/[0-9]|Twitterbot|Pinterest|Google.<span class="k">*</span>snippet<span class="o">)</span>
    RewriteRule ^blog/<span class="o">(</span>.<span class="k">*</span><span class="o">)</span><span class="nv">$ </span>http://joaogarin.com/blog_backoffice/<span class="nv">$1</span> <span class="o">[</span>P]
&lt;/ifModule&gt;</code></pre></figure>

<p>One you have this it will check the user agent for the correspondent crwalers, in this case Facebook, twitter, pinterest and google plus and it will redirect to the blog_backoffice directory where drupal is. You could essencially use anything here as long as you can map between them somehow. In my case its very easy since the URL’s follow the same pattern.</p>

<h2 id="testing-it">Testing it</h2>

<p>You can now go ahead and test it out in each of the platforms.</p>

<ul>
  <li><a href="https://developers.facebook.com/tools/debug/">Facebook Open Graph Object Debugger</a></li>
  <li><a href="https://dev.twitter.com/docs/cards/validation/validator">Twitter Card Validator</a></li>
  <li><a href="https://developers.pinterest.com/rich_pins/validator/">Pinterest Rich Pin Validator</a></li>
  <li><a href="http://www.google.com/webmasters/tools/richsnippets">Google Structured Data Testing tool</a></li>
</ul>

<p>Enjoy your Angular App with Drupal backoffice.</p>

          </div>
          <div class="article-share">
            
            
            <a href="https://twitter.com/home?status=Rich+sharing+links+in+your+angularJs+headless+drupal+application%20-%20/posts/rich-sharing-links-in-your-angularjs-headless-drupal-application%20by%20@joaogarin" title="Share on Twitter" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6 -18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6 0.8 15 2.5 22.1 -80.5-4-151.9-42.6-199.6-101.3 -8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7C67 210.7 52 206.3 39 199c0 0.4 0 0.8 0 1.2 0 47 33.4 86.1 77.7 95 -8.1 2.2-16.7 3.4-25.5 3.4 -6.2 0-12.3-0.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3 -33.1 26-74.9 41.5-120.3 41.5 -7.8 0-15.5-0.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-0.1-8.4-0.3-12.5C462.6 146 479 129 492 109.5z"/></svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=/posts/rich-sharing-links-in-your-angularjs-headless-drupal-application" title="Share on Facebook" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M288 192v-38.1c0-17.2 3.8-25.9 30.5-25.9H352V64h-55.9c-68.5 0-91.1 31.4-91.1 85.3V192h-45v64h45v192h83V256h56.4l7.6-64H288z"/></svg>
            </a>
            <a href="https://plus.google.com/share?url=/posts/rich-sharing-links-in-your-angularjs-headless-drupal-application" title="Share on Google+" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 128 128"><path d="M40.7 55.9v16.1c0 0 15.6 0 22 0C59.2 82.5 53.8 88.2 40.7 88.2c-13.3 0-23.7-10.8-23.7-24.2s10.4-24.2 23.7-24.2c7.1 0 11.6 2.5 15.8 5.9 3.3-3.3 3.1-3.8 11.6-11.9 -7.2-6.6-16.8-10.6-27.4-10.6C18.2 23.3 0 41.5 0 64c0 22.5 18.2 40.7 40.7 40.7 33.6 0 41.8-29.3 39-48.8H40.7zM113.9 56.7V42.6h-10.1v14.1H89.4v10.1h14.5v14.5h10.1V66.8H128V56.7H113.9z"/></svg>
            </a>
          </div>

          
            <div id="disqus_thread" class="article-comments"></div>
            <script src="https://joaogarinblog.disqus.com/embed.js" async defer></script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
          
        </article>
        <footer class="footer scrollappear">
  <p>
    This site is powered by Jekyll and Chalk theme. All content rights reserved to 
    <a href="/about" title="About me">Joao Garin</a>.
  </p>
</footer>

      </div>
    </div>
  </main>
  

<script src="/assets/vendor-130c9c254effc51f3283620bc635851da7b99c20901216948f11ba72ee13317f.js" type="text/javascript"></script>


  <script src="/assets/webfonts-96493456d319d1bf419afdf8701552d4d486fee6afd304897d4fd81eb4e0cc0b.js" type="text/javascript"></script>



  <script src="/assets/scrollappear-e2da8ea567e418637e31266cc5302126eaa79f62a2273739086358b589a89ee6.js" type="text/javascript"></script>


<script src="/assets/application-cfde13ac81ddaf4351b2e739603e2baf688d0fcc9aba613fe62bbb1c7b037fb9.js" type="text/javascript"></script>

</body>
</html>
